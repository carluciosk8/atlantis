#include "sprites.h"


const uint8_t sprite_figther1[] =
{
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,
    0x90,0x4C,0x43,0xBF,0xA9,0x42,0x94,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0xF0,0x8C,0xFF,0x00,0x00,0x80,
};
const uint8_t sprite_figther2[] =
{
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x60,0x30,0x3C,0x40,0x56,0x3C,0x68,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x00,
};

const uint8_t sprite_bomber1[] =
{
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
    0x49,0x24,0x12,0x2D,0x12,0x24,0x49,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,
    0x1C,0xE2,0x41,0xA1,0x41,0xE2,0x1C,0x80,
};
const uint8_t sprite_bomber2[] =
{
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x36,0x1B,0x0D,0x12,0x0D,0x1B,0x36,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x1C,0xB6,0x5A,0xB6,0x1C,0x00,0x00,
};

const uint8_t sprite_bandit1[] =
{
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x0F,0x05,0x00,0x00,0x00,0x05,0x0F,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0xC0,0x00,0xC0,0x3C,0xC0,0x00,0xC0
};
const uint8_t sprite_bandit2[] =
{
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x02,0x0F,0x06,0x0F,0x02,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00
};


const uint8_t sprites[] =
{
    // torpedo_center
    0x60,0xF0,0xF0,0x90,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

    // torpedo_right
    0x30,0xF8,0xF8,0x70,0x40,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

    // torpedo_left
    0x60,0xF8,0xF8,0x70,0x10,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

    /* color 9 */
    0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x00,
    0x04,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,
    0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
    /* color 11 */
    0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x07,
    0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

    /* color 9 */
    0x00,0x00,0x40,0x30,0x2C,0x13,0x08,0x08,
    0x10,0x2E,0x31,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0xC0,0x40,0x80,0x80,
    0x40,0x40,0xA0,0x60,0x10,0x00,0x00,0x00,
    /* color 11 */
    0x00,0x00,0x00,0x00,0x10,0x0C,0x07,0x07,
    0x0F,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,
    0x80,0x80,0x40,0x00,0x00,0x00,0x00,0x00,

    /* color 9 */
    0x01,0x01,0x73,0x3E,0x10,0x30,0xE0,0xF0,
    0x38,0x18,0x1B,0x3F,0x3E,0x38,0x30,0x40,
    0x00,0x82,0x86,0xDC,0x78,0x70,0x30,0x38,
    0x3C,0xF0,0xE0,0xF0,0x30,0x08,0x00,0x00,
    /* color 11 */
    0x00,0x00,0x00,0x01,0x0F,0x0F,0x1F,0x0F,
    0x07,0x07,0x04,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x80,0x80,0xC0,0xC0,
    0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

    /* color 9 */
    0x01,0x28,0x36,0x74,0xD0,0x05,0x70,0xF0,
    0x0A,0x31,0x79,0x41,0x29,0x1C,0x14,0x00,
    0xC0,0x00,0x0C,0xB4,0x50,0x12,0x8C,0x07,
    0x3C,0x52,0x0C,0x9A,0xA4,0xEC,0xB8,0x00,
    /* color 11 */
    0x00,0x03,0x08,0x09,0x0A,0x10,0x02,0x0B,
    0x55,0x06,0x02,0x3C,0x06,0x03,0x00,0x00,
    0x00,0xE0,0xF0,0x08,0xA0,0xCC,0x70,0x78,
    0xC2,0x0C,0xB0,0x60,0x18,0x00,0x00,0x00,

    /* color 9 */
    0x40,0x00,0x10,0x00,0x01,0x20,0x00,0x00,
    0x00,0x00,0x04,0x40,0x00,0x40,0x08,0x00,
    0x02,0x40,0x14,0x00,0x06,0x00,0x80,0x24,
    0x00,0x00,0x10,0x00,0x01,0x02,0x30,0x08,
    /* color 11 */
    0x00,0x00,0x02,0x00,0x04,0x04,0x08,0x00,
    0x18,0x22,0x00,0x00,0x20,0x0A,0x00,0x00,
    0x00,0x00,0x80,0x10,0x00,0x48,0x00,0x00,
    0x08,0x04,0x00,0x40,0x18,0x00,0x00,0x00,

    /* --- Slot 0 */
    0x04,0x06,0x03,0x01,0x04,0x06,0x03,0x01,
    0x04,0x06,0x03,0x01,0x04,0x06,0x03,0x01,
    0x20,0x60,0xC0,0x80,0x20,0x60,0xC0,0x80,
    0x20,0x60,0xC0,0x80,0x20,0x60,0xC0,0x80,
    /* --- Slot 1 */
    0x01,0x04,0x06,0x03,0x01,0x04,0x06,0x03,
    0x01,0x04,0x06,0x03,0x01,0x04,0x06,0x03,
    0x80,0x20,0x60,0xC0,0x80,0x20,0x60,0xC0,
    0x80,0x20,0x60,0xC0,0x80,0x20,0x60,0xC0,
    /* --- Slot 2 */
    0x03,0x01,0x04,0x06,0x03,0x01,0x04,0x06,
    0x03,0x01,0x04,0x06,0x03,0x01,0x04,0x06,
    0xC0,0x80,0x20,0x60,0xC0,0x80,0x20,0x60,
    0xC0,0x80,0x20,0x60,0xC0,0x80,0x20,0x60,
    /* --- Slot 3 */
    0x06,0x03,0x01,0x04,0x06,0x03,0x01,0x04,
    0x06,0x03,0x01,0x04,0x06,0x03,0x01,0x04,
    0x60,0xC0,0x80,0x20,0x60,0xC0,0x80,0x20,
    0x60,0xC0,0x80,0x20,0x60,0xC0,0x80,0x20,
};


struct sprite_attr sprites_attributes[17] = {
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
    {88, 0, 25*4, 0},
    {88+16, 0, 25*4, 0},
    {88+32, 0, 25*4, 0},
    {88+48, 0, 25*4, 0},
    {88+64, 0, 25*4, 0},
    {0, 0, 0, 0},
    {0, 0, 0, 0},
};


const uint8_t sprites_explosion_anim1[] = { 15*4, 17*4, 19*4, 21*4, 23*4 };
const uint8_t sprites_explosion_anim2[] = { 16*4, 18*4, 20*4, 22*4, 24*4 };


void init_sprites()
{
    ubox_wvdp(1, 0xe2);
    ubox_set_sprite_pat16(sprite_figther1, 0);
    ubox_set_sprite_pat16(sprite_figther2, 1);
    ubox_set_sprite_pat16_flip(sprite_figther1, 2);
    ubox_set_sprite_pat16_flip(sprite_figther2, 3);
    ubox_set_sprite_pat16(sprite_bomber1, 4);
    ubox_set_sprite_pat16(sprite_bomber2, 5);
    ubox_set_sprite_pat16_flip(sprite_bomber1, 6);
    ubox_set_sprite_pat16_flip(sprite_bomber2, 7);
    ubox_set_sprite_pat16(sprite_bandit1, 8);
    ubox_set_sprite_pat16(sprite_bandit2, 9);
    ubox_set_sprite_pat16_flip(sprite_bandit1, 10);
    ubox_set_sprite_pat16_flip(sprite_bandit2, 11);
    ubox_write_vm((uint8_t*)0x3800 + 384, 544, sprites);
}


void sprites_disable_deathray()
{
    sprites_attributes[10].attr = 0;
    sprites_attributes[11].attr = 0;
    sprites_attributes[12].attr = 0;
    sprites_attributes[13].attr = 0;
    sprites_attributes[14].attr = 0;
}


void sprites_update_deathray(uint8_t x, uint8_t frame)
{
    sprites_attributes[10].x = x;
    sprites_attributes[11].x = x;
    sprites_attributes[12].x = x;
    sprites_attributes[13].x = x;
    sprites_attributes[14].x = x;
    sprites_attributes[10].pattern = 25*4 + frame*4;
    sprites_attributes[11].pattern = sprites_attributes[10].pattern;
    sprites_attributes[12].pattern = sprites_attributes[10].pattern;
    sprites_attributes[13].pattern = sprites_attributes[10].pattern;
    sprites_attributes[14].pattern = sprites_attributes[10].pattern;
    sprites_attributes[10].attr = 8 + frame;
    sprites_attributes[11].attr = sprites_attributes[10].attr;
    sprites_attributes[12].attr = sprites_attributes[10].attr;
    sprites_attributes[13].attr = sprites_attributes[10].attr;
    sprites_attributes[14].attr = sprites_attributes[10].attr;
}
